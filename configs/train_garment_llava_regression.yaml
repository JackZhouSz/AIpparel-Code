# Training configuration for Pattern Shape prediction model 
# (part I of NeuralTailor)

# 0.5 * stitch cls loss (focal loss) + 0.005 * stitch ce loss + 5 * panel loss
defaults: 
  - data_wrapper: qva_garment_token_data_wrapper
  - trainer: llava_garment_token_trainer
  - experiment: experiment
  - model: llava_garment_token
  - _self_
  - override data_wrapper/dataset/garment_tokenizer: regression_garment_tokenizer

model:
  use_mm_start_end: True
  edge_loss_weight: 0.1

experiment:
  run_name: finetune_llava_garment_token

data_wrapper:
  collate_fn: data.data_wrappers.collate_fns.collate_fn_regression

from_start: False
model_max_length: 2100
version: liuhaotian/llava-v1.5-7b
precision: bf16
eval_only: False
gen_only: False
eval_train: False
eval_val: True
conv_type: llava_v1
pre_trained: null
storage_dir: null
hydra:
  run:
    dir: /miele/george/garment/sewformer/outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}